<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Phoenix Pan&#39;s">
<meta property="og:url" content="http://www.phoenixpan.com/blog/index.html">
<meta property="og:site_name" content="Phoenix Pan&#39;s">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Phoenix Pan&#39;s">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.phoenixpan.com/blog/"/>





  <title>Phoenix Pan's</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Phoenix Pan's</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/10/11/SystemDesign/User System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/10/11/SystemDesign/User System/" itemprop="url">User System</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-11T14:48:36+11:00">
                2017-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/System-Design/" itemprop="url" rel="index">
                    <span itemprop="name">System Design</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Senario"><a href="#Senario" class="headerlink" title="Senario"></a>Senario</h2><p>Request types: User register, user login, user query, user info update.<br>Assume DAU is 100 million.  </p>
<p>User register, user login, and user info update altogether: 0.5/user/day, QPS ~100<br>User query: 100/user/day, QPS~100,000  </p>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><h4 id="User-service"><a href="#User-service" class="headerlink" title="User service"></a>User service</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">User getUser() &#123;</div><div class="line">  key = userId + salt;</div><div class="line">  user = cache.get(key);</div><div class="line">  if (user) </div><div class="line">    return user;</div><div class="line">  user = database.get(userId); // mark</div><div class="line">  cache.set(key, user);</div><div class="line">  return user;</div><div class="line">&#125;</div><div class="line"></div><div class="line">User setUser(User user) &#123;</div><div class="line">  key = user.id + salt;</div><div class="line">  cache.delete(key); // order matters here</div><div class="line">  database.set(user); </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Which implementation is better?<br>A. <code>cache.delete(key); database.set(user);</code><br>B. <code>database.set(user); cache.delete(key);</code><br>C. <code>cache.set(key); database.set(user);</code><br>D. <code>database.set(user); cache.set(key);</code></p>
<p>A, because B,C,D will easily cause data corruption(mismatch) in case of one operation falls. Case A usually does not cause dirty data, unless setUser() was invoked after the marked place in getUser(), which causes an older version of user been stored in cache. </p>
<p>To avoid the inconsistency issues, which may occur here and there in a concurrent system, we should set a cache timeout, so we can make sure that all data will <strong>eventually</strong> be the same.</p>
<h4 id="Authentication-service"><a href="#Authentication-service" class="headerlink" title="Authentication service"></a>Authentication service</h4><p><strong>After a user logged in:</strong></p>
<ol>
<li>The server creates a session table(session_key, user_id, expire_time)</li>
<li>Return session_key as cookie </li>
<li>User browser stores the session_key</li>
<li>Every request the user sent will take along with it all cookies from this site(so don’t make too many cookies)</li>
<li>If the server sees the session_key in the cookie is effective, log in the user</li>
</ol>
<p><strong>Where should we put the sessions? cache? database?</strong><br>Both. In case we lost all session tables in cache, a great number of users will try to log in at the same time, causing problems. </p>
<h4 id="Friendship-service"><a href="#Friendship-service" class="headerlink" title="Friendship service"></a>Friendship service</h4><p>One-way or two-way. Usually in NoSQL database as it’s simple.</p>
<h2 id="Storgae"><a href="#Storgae" class="headerlink" title="Storgae"></a>Storgae</h2><ol>
<li>SQL: ~1k QPS</li>
<li>NoSQL: ~10k QPS</li>
<li>In-memory NoSQL(Redis / Memcached): ~100k QPS</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/10/11/General/Enable Https Connection For GithubPages With Custom Domain/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/10/11/General/Enable Https Connection For GithubPages With Custom Domain/" itemprop="url">Enable Https Connection For GithubPages With Custom Domain</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-11T00:12:18+11:00">
                2017-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/General/" itemprop="url" rel="index">
                    <span itemprop="name">General</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Follow the general steps from this <a href="https://blog.cloudflare.com/secure-and-fast-github-pages-with-cloudflare/" target="_blank" rel="external">official instruction</a> from CloudFlare. </p>
<p>Several things you may need to notice: </p>
<ol>
<li>You need a <code>CNAME</code> file in your repo root, containing only one line: <code>yourdomain.com</code> <strong>OR</strong> <code>www.yourdomain.com</code>. It decides which domain will response by default. Personally, I prefer the one with <code>www</code></li>
<li>Configure your DNS in CloudFlare:<br>The first rule enables <code>yourdomain.com</code> and the second enables <code>www.yourdomain.com</code><br><img src="https://user-images.githubusercontent.com/14355257/31495829-cbeaa142-afa4-11e7-95da-af7f68dbf1bc.png" alt="seetting1"> </li>
<li>Configure your Page Rules to allow Https connections<br>Order matters!<br><img src="https://user-images.githubusercontent.com/14355257/31495830-cd092e0e-afa4-11e7-9788-efb7559a5be9.png" alt="seetting2"></li>
</ol>
<p><strong>Notice:</strong> It takes a long time for the updated DNS to be effective, be patient and do not worry and change things randomly. I waited for about 24 hours. </p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.jonathan-petitcolas.com/2017/01/13/using-https-with-custom-domain-name-on-github-pages.html" target="_blank" rel="external">https://www.jonathan-petitcolas.com/2017/01/13/using-https-with-custom-domain-name-on-github-pages.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/10/09/SystemDesign/News Feeds System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/10/09/SystemDesign/News Feeds System/" itemprop="url">News Feed System</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-09T22:15:03+11:00">
                2017-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/System-Design/" itemprop="url" rel="index">
                    <span itemprop="name">System Design</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="News-Feed-System"><a href="#News-Feed-System" class="headerlink" title="News Feed System"></a>News Feed System</h1><h2 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h2><ol>
<li>Your <strong>news feed</strong> consists of the <strong>timelines</strong> of all your friends or users that you are following</li>
<li>Core algorithm: merge k sorted array/list/any</li>
<li>Daily active users(DAU), monthly active users(MAU), query per second(QPS). Peak value and growth expectation</li>
<li>Number of reads and writes</li>
<li>Examples:  <ul>
<li>Twitter</li>
<li>Facebook</li>
<li>朋友圈</li>
</ul>
</li>
</ol>
<h2 id="Pull-model-and-Push-model"><a href="#Pull-model-and-Push-model" class="headerlink" title="Pull model and Push model"></a>Pull model and Push model</h2><h3 id="Pull-model"><a href="#Pull-model" class="headerlink" title="Pull model"></a>Pull model</h3><p>Get the first N tweets from K(all of your) following users, merge them, and then take the first N tweets. </p>
<p><strong>Problem:</strong> Long waiting period. It takes K times blocking (阻塞型) DB read request to load the news feed.</p>
<p><strong>Solution:</strong> Cache, for both timeline and news feed:</p>
<ol>
<li>Cache timeline: cache the most recent n tweets for each user (DB read –&gt; cache read)</li>
<li>Cache news feed: If read within x seconds from the last time, read from cache. If not, only merge the K tweets after a certain timestamp (such as since the last update)</li>
</ol>
<h3 id="Push-mode"><a href="#Push-mode" class="headerlink" title="Push mode"></a>Push mode</h3><p>Store a news feed list in the <strong>database</strong> for each user. When a user publishes a new tweet, do a <strong>fanout</strong> to push the tweet to all the news feed lists of his/her followers. The fanout is performed asynchronously in another task. </p>
<p><strong>Problem:</strong> Delayed display for some users. If we have a star user who has 100 million followers, the fanout will have 100 million write operations, which could take hours and is unacceptable for those unlucky followers. </p>
<p><strong>Solution:</strong> Rank users by active level; find star users(who have a lot of followers) and use pull model for them.</p>
<h3 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison"></a>Comparison</h3><table>
<thead>
<tr>
<th>Item</th>
<th>pull</th>
<th>push</th>
</tr>
</thead>
<tbody>
<tr>
<td>DB read</td>
<td>K (num of following)</td>
<td>1</td>
</tr>
<tr>
<td>DB write</td>
<td>1</td>
<td>K (num of follower)</td>
</tr>
<tr>
<td>Demand for resources</td>
<td>expensive (memory)</td>
<td>cheap (disk)</td>
</tr>
<tr>
<td>Delay</td>
<td>low</td>
<td>high (to hear from stars)</td>
</tr>
<tr>
<td>Active level</td>
<td>users post frequently</td>
<td>users post unfrequently</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/10/06/General/Configure Hexo for GithubPages/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/10/06/General/Configure Hexo for GithubPages/" itemprop="url">Get Hexo running on Github Pages</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-06T23:44:12+11:00">
                2017-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/General/" itemprop="url" rel="index">
                    <span itemprop="name">General</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Install-Hexo"><a href="#Install-Hexo" class="headerlink" title="Install Hexo"></a>Install Hexo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-cli -g</div></pre></td></tr></table></figure>
<h2 id="Initialize-the-blog"><a href="#Initialize-the-blog" class="headerlink" title="Initialize the blog"></a>Initialize the blog</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">hexo init blog</div><div class="line">npm install</div><div class="line">hexo g #generate</div><div class="line">hexo s #server</div><div class="line">hexo d #deploy</div></pre></td></tr></table></figure>
<p>To deploy on Github, we need to install git deployer and modify the _config.yml file in root:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#Configure _config.yml </div><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repo: git@github.com:PhoenixPan/blog.git</div><div class="line">  branch: master</div></pre></td></tr></table></figure>
<p>You have to add your local ssh key to your github account, otherwise you won’t be able to display the site, find instruction <a href="https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/" target="_blank" rel="external">here</a></p>
<h2 id="Install-themes"><a href="#Install-themes" class="headerlink" title="Install themes"></a>Install themes</h2><p>Clone the new theme under themes directory<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/iissnan/hexo-theme-next.git themes/next</div></pre></td></tr></table></figure></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">hexo-theme-next</a><br><a href="https://linghucong.js.org/2016/04/15/2016-04-15-hexo-github-pages-blog/" target="_blank" rel="external">手把手教你使用Hexo + Github Pages搭建个人独立博客</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/08/16/Linux/Screen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/08/16/Linux/Screen/" itemprop="url">Linux - screen</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-16T13:15:47+10:00">
                2017-08-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Screen"><a href="#Screen" class="headerlink" title="Screen"></a>Screen</h1><h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><p>All commends lead by <code>ctrl+a</code>, followed by <code>?</code> to check the entire reference. </p>
<ol>
<li><code>c</code> create new window</li>
<li><code>n</code> and <code>p</code>: next window / previous window</li>
<li><code>w</code> to see all windows</li>
<li><code>(ctrl+)&quot;</code> goes directly to the wanted window</li>
<li><code>A</code> change the window’s name (default: bash)</li>
<li><code>k</code> kill this window</li>
<li><code>\</code> quit screen and kill all windows</li>
<li><code>d</code> detach from a screen session to the main console, <code>screen -r</code> return to the screen session</li>
<li>What if we have multiple screen sessions? First, use <code>screen -ls</code> to check all screen sessions with ids, then use<code>screen -r 1234</code> to attach a certain session</li>
</ol>
<h2 id="Keep-processes-running-after-we-disconnected"><a href="#Keep-processes-running-after-we-disconnected" class="headerlink" title="Keep processes running after we disconnected"></a>Keep processes running after we disconnected</h2><ol>
<li>Enter screen by <code>screen</code></li>
<li>Create a new window <code>c</code></li>
<li>Run the process here</li>
<li>Detach screen <code>d</code></li>
<li>Disconnect</li>
</ol>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-screen-on-an-ubuntu-cloud-server" target="_blank" rel="external">Reference1</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/07/10/15619CouldComputing/Project2.1_Guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/07/10/15619CouldComputing/Project2.1_Guide/" itemprop="url">15619 Project2.1 Guide</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-10T18:45:09+10:00">
                2017-07-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/15619-Cloud-Computing/" itemprop="url" rel="index">
                    <span itemprop="name">15619 Cloud Computing</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Project2-1-Horizontal-Scaling-and-Advanced-Resource-Scaling"><a href="#Project2-1-Horizontal-Scaling-and-Advanced-Resource-Scaling" class="headerlink" title="Project2.1 Horizontal Scaling and Advanced Resource Scaling"></a>Project2.1 Horizontal Scaling and Advanced Resource Scaling</h1><p>Goal: Using APIs to programatically control AWS Load Balancer and Auto Scaling Group.</p>
<h2 id="Workflow"><a href="#Workflow" class="headerlink" title="Workflow"></a>Workflow</h2><ol>
<li>Create working instances</li>
<li>Create an elastic load balancer LB1: set up health check page</li>
<li>Create an auto-scaling launch configuration</li>
<li>Create an auto-scaling group: attach the ELB just created (advanced - load balancing) and use the same subnet</li>
</ol>
<h2 id="Elastic-Load-Balancer"><a href="#Elastic-Load-Balancer" class="headerlink" title="Elastic Load Balancer"></a>Elastic Load Balancer</h2><p>Elastic Load Balancer automatically divides traffic to connected instances and handles instance failures by doing health checks. The default distribution strategy is Round-Robin. If an instance is unhealthy, it will stop routing requests to it.</p>
<h2 id="Auto-Scaling-Group"><a href="#Auto-Scaling-Group" class="headerlink" title="Auto Scaling Group"></a>Auto Scaling Group</h2><p>Auto Scaling Group automatically adds or removes identical resources by responding to changes in demands. </p>
<p><strong>Auto Scaling Policy:</strong> Auto Scaling Group reacts when user-specified threadhols(i.e. CPU utilization) are triggered(by CloudWatch). It maintains a desired number(between specified minium and maximum) of instances at all times. It can also scale based on specific schedule(i.e. more server during the weekend). Auto Scaling Group does health checks as well. If an instance is unhealthy, it will launch new instances to replace them. </p>
<p><strong>Auto Scaling Template:</strong>  instance AMI, instance type, key pairs, security group, etc. The applications in the instances should run automatically when the instances are up.</p>
<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><ol>
<li>The auto-generated instances will NOT be tagged if you terminate it too soon after you launched them!</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/07/09/15619CouldComputing/Project1.2_Guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/07/09/15619CouldComputing/Project1.2_Guide/" itemprop="url">15619 Project1.2 Guide</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-09T23:22:17+10:00">
                2017-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/15619-Cloud-Computing/" itemprop="url" rel="index">
                    <span itemprop="name">15619 Cloud Computing</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Project1-2-Parallel-Programming-using-EMR"><a href="#Project1-2-Parallel-Programming-using-EMR" class="headerlink" title="Project1.2 Parallel Programming using EMR"></a>Project1.2 Parallel Programming using EMR</h1><p>Goal: filter and analyze a large dataset using Hadoop MapReducer through AWS EMR.  </p>
<h2 id="MapReduce-configuration"><a href="#MapReduce-configuration" class="headerlink" title="MapReduce configuration"></a>MapReduce configuration</h2><ol>
<li>Please do not use “.” (periods) or, in general, any other non alphanumeric characters in your bucket name (the bucket to which your mapper and reducer code is uploaded), otherwise the EMR job might fail.</li>
<li>You may want to preserve your cluster by unchecking the “Terminate on failure” option and adding steps manually in the EMR web console</li>
<li>Config:  </li>
</ol>
<p><img src="https://user-images.githubusercontent.com/14355257/26965668-f5d2c0c4-4d35-11e7-955b-bfc9f24cdfef.png" alt="image"></p>
<p>jar –cvf mapper.jar Mapper.class<br>jar –cvf reducer.jar Reducer.class</p>
<p>phoenixpan@Ghost:~/Desktop$ javac -cp test.jar Main.java <strong>doesn’t work</strong><br>phoenixpan@Ghost:~/Desktop$ java -cp test.jar Main <strong>will work</strong>  </p>
<p><img src="https://user-images.githubusercontent.com/14355257/26965671-f8793862-4d35-11e7-9449-339f9a5ed612.png" alt="image"></p>
<p>java -cp Mapper.jar Mapper<br>java -cp Reducer.jar Reducer</p>
<p>-files s3://ccproject0102/Mapper.jar,S3://ccproject0102/Reducer.jar</p>
<h2 id="Extra-practice-find-common-friends"><a href="#Extra-practice-find-common-friends" class="headerlink" title="Extra practice: find common friends"></a>Extra practice: find common friends</h2><p><img src="https://user-images.githubusercontent.com/14355257/26966264-87942708-4d38-11e7-801f-4fec9c370814.jpg" alt="mapr"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.phoenixpan.com/blog/blog/2017/07/09/15619CouldComputing/Project1.1_Guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Phoenix Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phoenix Pan's">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/07/09/15619CouldComputing/Project1.1_Guide/" itemprop="url">15619 Project1.1 Guide</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-09T17:45:21+10:00">
                2017-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/15619-Cloud-Computing/" itemprop="url" rel="index">
                    <span itemprop="name">15619 Cloud Computing</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Project1-1-Sequential-Programming"><a href="#Project1-1-Sequential-Programming" class="headerlink" title="Project1.1 Sequential Programming"></a>Project1.1 Sequential Programming</h1><p>Goal: Write script and code to filter and analyze a medium dataset locally. </p>
<h5 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h5><p>Firstly, we need to filter the data with our programs before analyzing it. I used Java, but you can use Python or Bash if you feel comfortable with them. In my program, I used a BufferedReader to check each line. Since the result data set has to be sorted, I temporarily store all matches in an ArrayList, which will be sorted at the end. However, for a larger data set, this approach is not recommended, as it will exhausts your memory. If you’re confused by some filtering conditions, please ask your TAs to make it clear, as it may affect your result greatly.   </p>
<h5 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h5><p>As for analysis, we have to answer nine questions using the data set we got. If you think your answer-hunting programs are correct, you’d better go back to chcek your filter program to see whether you’ve misunderstood some conditions. For the first several questions, such as counting the total number of lines, I <strong>strongly recommand</strong> you to use Bash. One reason is because the prorams will be really simple. You may need only one line to complete your job, another reason is that you will have to use Bash in a future project anyway. Yes, you’ll not run away from it, so enjoy. For complited questions, you will use regular expression to match the works. This site can check your expressions: <a href="https://regex101.com/" target="_blank" rel="external">https://regex101.com/</a>. To fill in the answer sheet (runner.sh), you need to open it with a compiler (I used vim), and put your code in.</p>
<p>For Java users, replace the “echo” with “javac” and “java” there. Please also upload your code to the same folder:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">answer_2() &#123;</div><div class="line">        javac Project1_1.java</div><div class="line">        java Project1_1</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>For Bash users, replace the “echo” with your command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">answer_1() &#123;</div><div class="line">	grep -P &apos;Keyword&apos; FileName.csv | wc -l</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Test your answers by running<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./runner.sh</div></pre></td></tr></table></figure></p>
<p>If everything seems alright, submitted it. You should have unlimited tries throughout all the projects, but please confirm this with your TAs. </p>
<p>Generally, it’s an easy project to warm you up. I have no programming foundation, but it costs me only one day to finish. Cheers. </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Phoenix Pan</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Phoenix Pan</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  
  

  

  

  

</body>
</html>
